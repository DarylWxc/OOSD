<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List of students</title>
  </head>
  <body>
    <h1>List of All Students</h1>
    <a href="/add">Add New Student</a>
    <a href="/grade">Grade</a>
    <% students.forEach(item => { %>
    <ul>
      <li style="color: red; font-weight: 700">
        Name:<%= item.firstname + " " + item.lastname %>
      </li>
      <li>Email:<%= item.email %></li>
      <li>Age:<%= item.age %></li>
      <a href="/edit/<%= item.id %>" >Edit Student</a>
      <a onclick="DeleteData({id:'<%= item.id %>',name:'<%= item.firstname  + item.lastname %>'})" style="cursor: pointer;text-decoration: underline;color:#0000ee">Delete</a>
    </ul>
    <% }) %>
    <dialog id="confirm_Dialog">
        <p id="confirm_content">Are you sure want to delete Student?</p>
        <button id="ok" onclick="OK()">OK</button>
        <button id="cancel" onclick="Cancel()">Cancel</button>
    </dialog>
    <script>
        let currentId = 0;
        const confirmText = document.getElementById("confirm_content");
        const confirmDialog = document.getElementById("confirm_Dialog");

        function DeleteData(student){
            // console.log(student);
            confirmText.innerText = `Are you sure want to delete Student ${student.name}`;
            currentId = student.id;
            confirmDialog.showModal();
        }

        function OK(){
            // console.log(currentId)
            const getDelete = document.createElement('a');
            getDelete.href = `/delete/${currentId}`;
            getDelete.click();
            getDelete.remove();
        }

        function Cancel(){
            confirmDialog.close();
        }
    </script>
  </body>
</html>
