<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>List of users</title>
    <link rel="stylesheet" href="userList.css" />
  </head>
  <body>
    <h1>List of Users</h1>
    <button class="add-btn" onclick="ContactPage()">Contact Us!</button>
    <table id="user-table" :border="1">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>FeedBack Message</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="user-list">
        <% users.forEach(item => { %>
        <tr>
          <th><%= item.firstname + " " + item.lastname %></th>
          <td><%= item.email %></td>
          <td><%= item.feedback %></td>
          <td class="btn" onclick="Edit('<%= item.id %>')">Edit</td>
          <td
            class="btn"
            onclick="Delete({id:'<%= item.id %>',name:'<%= item.firstname  + item.lastname %>'})"
          >
            Delete
          </td>
        </tr>
        <% }) %>
      </tbody>
    </table>

    <dialog id="confirm_Dialog">
      <p id="confirm_content">Are you sure want to delete Student?</p>
      <button id="ok" onclick="OK()">OK</button>
      <button id="cancel" onclick="Cancel()">Cancel</button>
    </dialog>

    <script>
      let currentId = 0;
      const confirmText = document.getElementById("confirm_content");
      const confirmDialog = document.getElementById("confirm_Dialog");

      // Edit User
      function Edit(id) {
        window.location.href = `/edit/${id}`;
      }

      // Delete User
      function Delete(user) {
        confirmText.innerText = `Are you sure want to delete User ${user.name}`;
        currentId = user.id;
        confirmDialog.showModal();
      }

      // Make Sure to Del UserData
      function OK() {
        const getDelete = document.createElement("a");
        getDelete.href = `/deleteUser/${currentId}`;
        getDelete.click();
        getDelete.remove();
      }

      // Cancelation
      function Cancel() {
        confirmDialog.close();
      }

      // Add New Contact User
      function ContactPage() {
        window.location.href = "/contact";
      }
    </script>
  </body>
</html>
